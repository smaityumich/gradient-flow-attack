SLURM_JOBID:  6797523
SLURM_ARRAY_TASK_ID:  8
SLURM_ARRAY_JOB_ID:  6797514
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
2020-06-01 12:45:32.905900: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-06-01 12:45:32.905938: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: UNKNOWN ERROR (303)
2020-06-01 12:45:32.905964: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3074.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-06-01 12:45:32.906315: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-06-01 12:45:32.913276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3000000000 Hz
2020-06-01 12:45:32.913390: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aaee9420b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-06-01 12:45:32.913401: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Real and fair distances (max/min/mean):
0.0 0.0 0.0
0.0 0.0 0.0
Counter success count is -1
Epoch 0 train accuracy 0.727589; loss 0.604884; lambda is 2.000000
Epoch 0 test accuracy 0.731454
Epoch 0 spouse consistency 0.928579
Train AUC is 0.520981; balanced AUC is 0.520981
Train accuracy 0.728; balanced accuracy 0.524; FDR 0.643; TPR 0.119

Train Gender accuracy 0.679; balanced accuracy 0.527; FDR 0.545; TPR 0.118

Train Gender gap RMS 0.011837664701372338
Train Race accuracy 0.718; balanced accuracy 0.526; FDR 0.613; TPR 0.119

Train Race gap RMS 0.016573398717349506
Train STD accuracy 0.020; balanced accuracy 0.000; FDR 0.034; TPR 0.000

--------------------------------------------------
Test AUC is 0.527354; balanced AUC is 0.527354
Test accuracy 0.731; balanced accuracy 0.526; FDR 0.643; TPR 0.125

Test Gender accuracy 0.684; balanced accuracy 0.530; FDR 0.542; TPR 0.126

Test Gender gap RMS 0.012556887236670542
Test Race accuracy 0.725; balanced accuracy 0.530; FDR 0.602; TPR 0.128

Test Race gap RMS 0.033327716130597984
Test STD accuracy 0.020; balanced accuracy 0.000; FDR 0.030; TPR 0.001

--------------------------------------------------
Real and fair distances (max/min/mean):
909479.6986891374 17389.968317277853 212076.22250716444
0.00090810686 7.592442e-06 0.000798617
Counter success count is -1
Epoch 1000 train accuracy 0.694364; loss 0.629038; lambda is 1.465587
Epoch 1000 test accuracy 0.696075
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.698324; subspace 1.077453; adv 1.091149
Epoch 1000 spouse consistency 0.878607
Train AUC is 0.570189; balanced AUC is 0.570189
Train accuracy 0.694; balanced accuracy 0.551; FDR 0.651; TPR 0.265

Train Gender accuracy 0.654; balanced accuracy 0.548; FDR 0.582; TPR 0.266

Train Gender gap RMS 0.01085245448755637
Train Race accuracy 0.688; balanced accuracy 0.552; FDR 0.630; TPR 0.264

Train Race gap RMS 0.014680704209073657
Train STD accuracy 0.017; balanced accuracy 0.002; FDR 0.024; TPR 0.001

--------------------------------------------------
Test AUC is 0.575433; balanced AUC is 0.575433
Test accuracy 0.696; balanced accuracy 0.552; FDR 0.656; TPR 0.271

Test Gender accuracy 0.659; balanced accuracy 0.553; FDR 0.580; TPR 0.276

Test Gender gap RMS 0.02312488237467935
Test Race accuracy 0.692; balanced accuracy 0.555; FDR 0.631; TPR 0.274

Test Race gap RMS 0.02555619525897602
Test STD accuracy 0.016; balanced accuracy 0.001; FDR 0.026; TPR 0.001

--------------------------------------------------
Real and fair distances (max/min/mean):
733723.4037138531 30431.150507943385 213970.43313171208
0.00090213906 0.00010924725 0.00081971806
Counter success count is -1
Epoch 2000 train accuracy 0.702104; loss 0.623597; lambda is 1.225296
Epoch 2000 test accuracy 0.702377
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.682312; subspace 0.878888; adv 0.892115
Epoch 2000 spouse consistency 0.884245
Train AUC is 0.599896; balanced AUC is 0.599896
Train accuracy 0.702; balanced accuracy 0.565; FDR 0.626; TPR 0.292

Train Gender accuracy 0.665; balanced accuracy 0.563; FDR 0.553; TPR 0.290

Train Gender gap RMS 0.010166610421808435
Train Race accuracy 0.696; balanced accuracy 0.566; FDR 0.605; TPR 0.292

Train Race gap RMS 0.00984380819107562
Train STD accuracy 0.015; balanced accuracy 0.001; FDR 0.026; TPR 0.001

--------------------------------------------------
Test AUC is 0.605019; balanced AUC is 0.605019
Test accuracy 0.702; balanced accuracy 0.567; FDR 0.633; TPR 0.302

Test Gender accuracy 0.668; balanced accuracy 0.567; FDR 0.555; TPR 0.303

Test Gender gap RMS 0.004334165577335331
Test Race accuracy 0.698; balanced accuracy 0.570; FDR 0.609; TPR 0.305

Test Race gap RMS 0.023043800119388985
Test STD accuracy 0.015; balanced accuracy 0.001; FDR 0.027; TPR 0.001

--------------------------------------------------
Real and fair distances (max/min/mean):
563459.5790470727 20125.422420398616 210350.06509126746
0.00090432516 0.0001026728 0.00082754885
Counter success count is -1
Epoch 3000 train accuracy 0.714377; loss 0.612999; lambda is 1.009339
Epoch 3000 test accuracy 0.714207
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.662595; subspace 0.823839; adv 0.836773
Epoch 3000 spouse consistency 0.899392
Train AUC is 0.636206; balanced AUC is 0.636206
Train accuracy 0.714; balanced accuracy 0.580; FDR 0.596; TPR 0.313

Train Gender accuracy 0.680; balanced accuracy 0.579; FDR 0.517; TPR 0.310

Train Gender gap RMS 0.015431912928466848
Train Race accuracy 0.707; balanced accuracy 0.580; FDR 0.576; TPR 0.313

Train Race gap RMS 0.008556246098657086
Train STD accuracy 0.014; balanced accuracy 0.001; FDR 0.029; TPR 0.001

--------------------------------------------------
Test AUC is 0.641224; balanced AUC is 0.641224
Test accuracy 0.714; balanced accuracy 0.582; FDR 0.605; TPR 0.323

Test Gender accuracy 0.681; balanced accuracy 0.582; FDR 0.525; TPR 0.322

Test Gender gap RMS 0.0031212290308947786
Test Race accuracy 0.709; balanced accuracy 0.585; FDR 0.581; TPR 0.327

Test Race gap RMS 0.029346582105414652
Test STD accuracy 0.014; balanced accuracy 0.001; FDR 0.028; TPR 0.002

--------------------------------------------------
Real and fair distances (max/min/mean):
599665.8510429699 14532.638003083212 211618.399036763
0.00093649654 0.00010725936 0.00084792543
Counter success count is -1
Epoch 4000 train accuracy 0.725958; loss 0.600343; lambda is 0.813964
Epoch 4000 test accuracy 0.724046
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.655474; subspace 0.750557; adv 0.762884
Epoch 4000 spouse consistency 0.910116
Train AUC is 0.678702; balanced AUC is 0.678702
Train accuracy 0.726; balanced accuracy 0.599; FDR 0.564; TPR 0.347

Train Gender accuracy 0.694; balanced accuracy 0.598; FDR 0.482; TPR 0.342

Train Gender gap RMS 0.027122176880491403
Train Race accuracy 0.719; balanced accuracy 0.599; FDR 0.545; TPR 0.346

Train Race gap RMS 0.009451510220622888
Train STD accuracy 0.012; balanced accuracy 0.000; FDR 0.031; TPR 0.002

--------------------------------------------------
Test AUC is 0.683476; balanced AUC is 0.683476
Test accuracy 0.724; balanced accuracy 0.600; FDR 0.577; TPR 0.358

Test Gender accuracy 0.691; balanced accuracy 0.598; FDR 0.500; TPR 0.355

Test Gender gap RMS 0.010848297865400694
Test Race accuracy 0.719; balanced accuracy 0.602; FDR 0.554; TPR 0.361

Test Race gap RMS 0.02681846151847528
Test STD accuracy 0.014; balanced accuracy 0.002; FDR 0.027; TPR 0.003

--------------------------------------------------
Real and fair distances (max/min/mean):
555608.7190490928 12701.868824209774 210098.24834117186
0.0009466944 0.00012867292 0.00087116443
Counter success count is -1
Epoch 5000 train accuracy 0.735108; loss 0.585909; lambda is 0.654769
Epoch 5000 test accuracy 0.734549
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.633651; subspace 0.718543; adv 0.730983
Epoch 5000 spouse consistency 0.915202
Train AUC is 0.724088; balanced AUC is 0.724088
Train accuracy 0.735; balanced accuracy 0.621; FDR 0.538; TPR 0.395

Train Gender accuracy 0.707; balanced accuracy 0.620; FDR 0.455; TPR 0.389

Train Gender gap RMS 0.02968131848231022
Train Race accuracy 0.728; balanced accuracy 0.620; FDR 0.520; TPR 0.393

Train Race gap RMS 0.01582537466207836
Train STD accuracy 0.011; balanced accuracy 0.000; FDR 0.032; TPR 0.002

--------------------------------------------------
Test AUC is 0.728211; balanced AUC is 0.728211
Test accuracy 0.735; balanced accuracy 0.624; FDR 0.548; TPR 0.409

Test Gender accuracy 0.706; balanced accuracy 0.623; FDR 0.470; TPR 0.407

Test Gender gap RMS 0.007725758868885204
Test Race accuracy 0.731; balanced accuracy 0.627; FDR 0.524; TPR 0.413

Test Race gap RMS 0.030890275677099
Test STD accuracy 0.013; balanced accuracy 0.002; FDR 0.027; TPR 0.003

--------------------------------------------------
Real and fair distances (max/min/mean):
637473.1437038166 15464.741936991923 214352.21898761022
0.0009443454 0.00013633358 0.00088721234
Counter success count is -1
Epoch 6000 train accuracy 0.747049; loss 0.568818; lambda is 0.516963
Epoch 6000 test accuracy 0.747485
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.615586; subspace 0.680898; adv 0.693414
Epoch 6000 spouse consistency 0.926589
Train AUC is 0.764649; balanced AUC is 0.764649
Train accuracy 0.747; balanced accuracy 0.649; FDR 0.509; TPR 0.454

Train Gender accuracy 0.722; balanced accuracy 0.648; FDR 0.428; TPR 0.451

Train Gender gap RMS 0.01346136762173866
Train Race accuracy 0.740; balanced accuracy 0.648; FDR 0.493; TPR 0.452

Train Race gap RMS 0.012088329582136646
Train STD accuracy 0.009; balanced accuracy 0.000; FDR 0.032; TPR 0.001

--------------------------------------------------
Test AUC is 0.767684; balanced AUC is 0.767684
Test accuracy 0.747; balanced accuracy 0.651; FDR 0.518; TPR 0.462

Test Gender accuracy 0.722; balanced accuracy 0.651; FDR 0.441; TPR 0.465

Test Gender gap RMS 0.01571546134974305
Test Race accuracy 0.743; balanced accuracy 0.652; FDR 0.497; TPR 0.464

Test Race gap RMS 0.017085476910541818
Test STD accuracy 0.011; balanced accuracy 0.001; FDR 0.028; TPR 0.000

--------------------------------------------------
Real and fair distances (max/min/mean):
673564.6336085595 14326.862517710226 215210.5777224827
0.00094829686 0.00018994519 0.0008898243
Counter success count is -1
Epoch 7000 train accuracy 0.756724; loss 0.552602; lambda is 0.389644
Epoch 7000 test accuracy 0.756551
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.568529; subspace 0.627040; adv 0.639083
Epoch 7000 spouse consistency 0.931786
Train AUC is 0.795028; balanced AUC is 0.795028
Train accuracy 0.757; balanced accuracy 0.682; FDR 0.489; TPR 0.532

Train Gender accuracy 0.735; balanced accuracy 0.680; FDR 0.415; TPR 0.533

Train Gender gap RMS 0.007725413458960771
Train Race accuracy 0.751; balanced accuracy 0.681; FDR 0.474; TPR 0.533

Train Race gap RMS 0.013148511766180707
Train STD accuracy 0.008; balanced accuracy 0.000; FDR 0.030; TPR 0.000

--------------------------------------------------
Test AUC is 0.797247; balanced AUC is 0.797247
Test accuracy 0.757; balanced accuracy 0.686; FDR 0.499; TPR 0.549

Test Gender accuracy 0.735; balanced accuracy 0.685; FDR 0.428; TPR 0.557

Test Gender gap RMS 0.03992482400583027
Test Race accuracy 0.752; balanced accuracy 0.687; FDR 0.481; TPR 0.551

Test Race gap RMS 0.01760079553828564
Test STD accuracy 0.009; balanced accuracy 0.001; FDR 0.026; TPR 0.003

--------------------------------------------------
Real and fair distances (max/min/mean):
525523.3925125676 13681.852011935232 215518.87587558894
0.0009561848 0.00023737265 0.0009053327
Counter success count is -1
Epoch 8000 train accuracy 0.766095; loss 0.536104; lambda is 0.276778
Epoch 8000 test accuracy 0.768823
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.566292; subspace 0.607073; adv 0.619326
Epoch 8000 spouse consistency 0.940077
Train AUC is 0.814300; balanced AUC is 0.814300
Train accuracy 0.766; balanced accuracy 0.712; FDR 0.474; TPR 0.605

Train Gender accuracy 0.747; balanced accuracy 0.710; FDR 0.406; TPR 0.612

Train Gender gap RMS 0.037466424357237765
Train Race accuracy 0.760; balanced accuracy 0.711; FDR 0.460; TPR 0.606

Train Race gap RMS 0.02402435119222451
Train STD accuracy 0.006; balanced accuracy 0.000; FDR 0.027; TPR 0.003

--------------------------------------------------
Test AUC is 0.816040; balanced AUC is 0.816040
Test accuracy 0.769; balanced accuracy 0.720; FDR 0.478; TPR 0.625

Test Gender accuracy 0.749; balanced accuracy 0.718; FDR 0.414; TPR 0.637

Test Gender gap RMS 0.06014585489365648
Test Race accuracy 0.764; balanced accuracy 0.720; FDR 0.463; TPR 0.628

Test Race gap RMS 0.02658963882627426
Test STD accuracy 0.008; balanced accuracy 0.001; FDR 0.024; TPR 0.004

--------------------------------------------------
Real and fair distances (max/min/mean):
608404.8399431538 16972.8273488074 212269.0047281785
0.0009636272 0.00037422142 0.00091830187
Counter success count is -1
Epoch 9000 train accuracy 0.773309; loss 0.521370; lambda is 0.177992
Epoch 9000 test accuracy 0.775014
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.546929; subspace 0.590588; adv 0.603027
Epoch 9000 spouse consistency 0.94262
Train AUC is 0.826183; balanced AUC is 0.826183
Train accuracy 0.773; balanced accuracy 0.733; FDR 0.464; TPR 0.654

Train Gender accuracy 0.756; balanced accuracy 0.731; FDR 0.399; TPR 0.664

Train Gender gap RMS 0.05725630581476702
Train Race accuracy 0.767; balanced accuracy 0.731; FDR 0.451; TPR 0.655

Train Race gap RMS 0.0284071769658691
Train STD accuracy 0.005; balanced accuracy 0.000; FDR 0.026; TPR 0.005

--------------------------------------------------
Test AUC is 0.827627; balanced AUC is 0.827627
Test accuracy 0.775; balanced accuracy 0.741; FDR 0.469; TPR 0.674

Test Gender accuracy 0.756; balanced accuracy 0.737; FDR 0.410; TPR 0.687

Test Gender gap RMS 0.06828009942236042
Test Race accuracy 0.771; balanced accuracy 0.741; FDR 0.454; TPR 0.680

Test Race gap RMS 0.04369435523794414
Test STD accuracy 0.007; balanced accuracy 0.002; FDR 0.022; TPR 0.004

--------------------------------------------------
Real and fair distances (max/min/mean):
769716.1642821457 17577.569214722684 214394.52745810893
0.00096755987 0.0003209373 0.00092580623
Counter success count is -1
Epoch 10000 train accuracy 0.774967; loss 0.508685; lambda is 0.092437
Epoch 10000 test accuracy 0.774903
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.522436; subspace 0.560949; adv 0.573392
Epoch 10000 spouse consistency 0.953455
Train AUC is 0.833983; balanced AUC is 0.833983
Train accuracy 0.775; balanced accuracy 0.741; FDR 0.462; TPR 0.672

Train Gender accuracy 0.757; balanced accuracy 0.737; FDR 0.402; TPR 0.683

Train Gender gap RMS 0.059600728553020864
Train Race accuracy 0.769; balanced accuracy 0.738; FDR 0.450; TPR 0.673

Train Race gap RMS 0.029106171355817136
Train STD accuracy 0.006; balanced accuracy 0.001; FDR 0.024; TPR 0.005

--------------------------------------------------
Test AUC is 0.835244; balanced AUC is 0.835244
Test accuracy 0.775; balanced accuracy 0.746; FDR 0.470; TPR 0.689

Test Gender accuracy 0.755; balanced accuracy 0.740; FDR 0.414; TPR 0.702

Test Gender gap RMS 0.07382383682593203
Test Race accuracy 0.770; balanced accuracy 0.745; FDR 0.457; TPR 0.694

Test Race gap RMS 0.043528315023589864
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.021; TPR 0.004

--------------------------------------------------
Real and fair distances (max/min/mean):
683209.3574832212 25437.23846698843 213682.69613670092
0.0009711313 0.00053079095 0.0009387138
Counter success count is -1
Epoch 11000 train accuracy 0.776598; loss 0.498395; lambda is 0.019754
Epoch 11000 test accuracy 0.77623
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.509663; subspace 0.545896; adv 0.558282
Epoch 11000 spouse consistency 0.959536
Train AUC is 0.839168; balanced AUC is 0.839168
Train accuracy 0.777; balanced accuracy 0.746; FDR 0.460; TPR 0.686

Train Gender accuracy 0.758; balanced accuracy 0.741; FDR 0.402; TPR 0.696

Train Gender gap RMS 0.06287767041397639
Train Race accuracy 0.770; balanced accuracy 0.744; FDR 0.449; TPR 0.687

Train Race gap RMS 0.033697646453970366
Train STD accuracy 0.006; balanced accuracy 0.001; FDR 0.023; TPR 0.004

--------------------------------------------------
Test AUC is 0.840318; balanced AUC is 0.840318
Test accuracy 0.776; balanced accuracy 0.750; FDR 0.468; TPR 0.699

Test Gender accuracy 0.755; balanced accuracy 0.743; FDR 0.416; TPR 0.711

Test Gender gap RMS 0.07426538480982896
Test Race accuracy 0.771; balanced accuracy 0.749; FDR 0.456; TPR 0.704

Test Race gap RMS 0.049415910384599825
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.020; TPR 0.003

--------------------------------------------------
Real and fair distances (max/min/mean):
602562.61116698 8672.46109412561 211231.59859500694
0.00097243866 0.00038274296 0.00094303134
Counter success count is -1
Epoch 12000 train accuracy 0.777538; loss 0.489622; lambda is 0.000010
Epoch 12000 test accuracy 0.777557
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.487690; subspace 0.530778; adv 0.543115
Epoch 12000 spouse consistency 0.959425
Train AUC is 0.842947; balanced AUC is 0.842947
Train accuracy 0.778; balanced accuracy 0.750; FDR 0.459; TPR 0.694

Train Gender accuracy 0.758; balanced accuracy 0.744; FDR 0.404; TPR 0.705

Train Gender gap RMS 0.06938528619274335
Train Race accuracy 0.771; balanced accuracy 0.747; FDR 0.448; TPR 0.696

Train Race gap RMS 0.03646081812215228
Train STD accuracy 0.007; balanced accuracy 0.002; FDR 0.022; TPR 0.005

--------------------------------------------------
Test AUC is 0.843975; balanced AUC is 0.843975
Test accuracy 0.778; balanced accuracy 0.754; FDR 0.466; TPR 0.707

Test Gender accuracy 0.757; balanced accuracy 0.746; FDR 0.414; TPR 0.719

Test Gender gap RMS 0.07754703004907597
Test Race accuracy 0.772; balanced accuracy 0.753; FDR 0.455; TPR 0.712

Test Race gap RMS 0.04976185165971848
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.020; TPR 0.004

--------------------------------------------------
Real and fair distances (max/min/mean):
747530.9062770181 14960.721683249965 209316.94557162886
0.00097214704 0.00053438946 0.00094448833
Counter success count is -1
Epoch 13000 train accuracy 0.778478; loss 0.482488; lambda is 0.000010
Epoch 13000 test accuracy 0.777004
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.501381; subspace 0.542080; adv 0.554783
Epoch 13000 spouse consistency 0.965616
Train AUC is 0.846074; balanced AUC is 0.846074
Train accuracy 0.778; balanced accuracy 0.753; FDR 0.458; TPR 0.702

Train Gender accuracy 0.758; balanced accuracy 0.746; FDR 0.405; TPR 0.713

Train Gender gap RMS 0.07099249201724889
Train Race accuracy 0.772; balanced accuracy 0.750; FDR 0.447; TPR 0.704

Train Race gap RMS 0.0403521701395634
Train STD accuracy 0.007; balanced accuracy 0.002; FDR 0.021; TPR 0.004

--------------------------------------------------
Test AUC is 0.847000; balanced AUC is 0.847000
Test accuracy 0.777; balanced accuracy 0.755; FDR 0.468; TPR 0.711

Test Gender accuracy 0.755; balanced accuracy 0.747; FDR 0.417; TPR 0.724

Test Gender gap RMS 0.08280049065740458
Test Race accuracy 0.771; balanced accuracy 0.753; FDR 0.456; TPR 0.715

Test Race gap RMS 0.04735292649690856
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.020; TPR 0.004

--------------------------------------------------
Real and fair distances (max/min/mean):
536185.5858912813 10373.971179417886 213854.4379508421
0.00096965476 0.00042476866 0.0009408145
Counter success count is -1
Epoch 14000 train accuracy 0.779224; loss 0.477168; lambda is 0.000010
Epoch 14000 test accuracy 0.777225
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.489887; subspace 0.520804; adv 0.533321
Epoch 14000 spouse consistency 0.966501
Train AUC is 0.848650; balanced AUC is 0.848650
Train accuracy 0.779; balanced accuracy 0.755; FDR 0.457; TPR 0.707

Train Gender accuracy 0.758; balanced accuracy 0.747; FDR 0.406; TPR 0.719

Train Gender gap RMS 0.07490520518190472
Train Race accuracy 0.773; balanced accuracy 0.752; FDR 0.447; TPR 0.710

Train Race gap RMS 0.04074115879947194
Train STD accuracy 0.007; balanced accuracy 0.003; FDR 0.020; TPR 0.005

--------------------------------------------------
Test AUC is 0.849458; balanced AUC is 0.849458
Test accuracy 0.777; balanced accuracy 0.757; FDR 0.468; TPR 0.717

Test Gender accuracy 0.756; balanced accuracy 0.749; FDR 0.417; TPR 0.731

Test Gender gap RMS 0.0857170444098304
Test Race accuracy 0.771; balanced accuracy 0.755; FDR 0.457; TPR 0.721

Test Race gap RMS 0.04789435048198917
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.020; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
584572.2673831622 13755.8831861523 215886.5623786228
0.0009713931 0.0003510162 0.000938341
Counter success count is -1
Epoch 15000 train accuracy 0.778782; loss 0.472831; lambda is 0.000010
Epoch 15000 test accuracy 0.778109
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.478697; subspace 0.512050; adv 0.524678
Epoch 15000 spouse consistency 0.967606
Train AUC is 0.850886; balanced AUC is 0.850886
Train accuracy 0.779; balanced accuracy 0.758; FDR 0.458; TPR 0.715

Train Gender accuracy 0.757; balanced accuracy 0.749; FDR 0.409; TPR 0.727

Train Gender gap RMS 0.07905149079589281
Train Race accuracy 0.772; balanced accuracy 0.755; FDR 0.448; TPR 0.718

Train Race gap RMS 0.04271182885964478
Train STD accuracy 0.008; balanced accuracy 0.003; FDR 0.020; TPR 0.005

--------------------------------------------------
Test AUC is 0.851622; balanced AUC is 0.851622
Test accuracy 0.778; balanced accuracy 0.760; FDR 0.466; TPR 0.724

Test Gender accuracy 0.756; balanced accuracy 0.751; FDR 0.417; TPR 0.738

Test Gender gap RMS 0.08819437399886153
Test Race accuracy 0.772; balanced accuracy 0.758; FDR 0.456; TPR 0.729

Test Race gap RMS 0.053283890563207974
Test STD accuracy 0.008; balanced accuracy 0.003; FDR 0.019; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
619706.9978305425 5339.473723739481 208900.69492288152
0.0009695485 9.970168e-05 0.0009373695
Counter success count is -1
Epoch 16000 train accuracy 0.780109; loss 0.469096; lambda is 0.000010
Epoch 16000 test accuracy 0.778994
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.475254; subspace 0.511959; adv 0.524673
Epoch 16000 spouse consistency 0.969486
Train AUC is 0.852942; balanced AUC is 0.852942
Train accuracy 0.780; balanced accuracy 0.760; FDR 0.456; TPR 0.721

Train Gender accuracy 0.758; balanced accuracy 0.752; FDR 0.408; TPR 0.734

Train Gender gap RMS 0.08440837951783287
Train Race accuracy 0.774; balanced accuracy 0.758; FDR 0.446; TPR 0.725

Train Race gap RMS 0.04732521895898506
Train STD accuracy 0.008; balanced accuracy 0.003; FDR 0.019; TPR 0.005

--------------------------------------------------
Test AUC is 0.853600; balanced AUC is 0.853600
Test accuracy 0.779; balanced accuracy 0.763; FDR 0.465; TPR 0.731

Test Gender accuracy 0.756; balanced accuracy 0.753; FDR 0.418; TPR 0.746

Test Gender gap RMS 0.09351383853413205
Test Race accuracy 0.773; balanced accuracy 0.761; FDR 0.456; TPR 0.736

Test Race gap RMS 0.05650668544464042
Test STD accuracy 0.008; balanced accuracy 0.004; FDR 0.019; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
615231.1792892504 8706.637032225815 211415.7153853772
0.00097115774 0.00015277215 0.0009374782
Counter success count is -1
Epoch 17000 train accuracy 0.780524; loss 0.465679; lambda is 0.000010
Epoch 17000 test accuracy 0.779436
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.472524; subspace 0.511907; adv 0.524862
Epoch 17000 spouse consistency 0.969707
Train AUC is 0.854745; balanced AUC is 0.854745
Train accuracy 0.781; balanced accuracy 0.762; FDR 0.456; TPR 0.726

Train Gender accuracy 0.758; balanced accuracy 0.753; FDR 0.409; TPR 0.739

Train Gender gap RMS 0.0873730669197704
Train Race accuracy 0.774; balanced accuracy 0.760; FDR 0.446; TPR 0.729

Train Race gap RMS 0.04749251083588214
Train STD accuracy 0.008; balanced accuracy 0.003; FDR 0.019; TPR 0.005

--------------------------------------------------
Test AUC is 0.855350; balanced AUC is 0.855350
Test accuracy 0.779; balanced accuracy 0.765; FDR 0.465; TPR 0.736

Test Gender accuracy 0.757; balanced accuracy 0.755; FDR 0.418; TPR 0.752

Test Gender gap RMS 0.09528899733201057
Test Race accuracy 0.773; balanced accuracy 0.763; FDR 0.456; TPR 0.742

Test Race gap RMS 0.06041989791330676
Test STD accuracy 0.008; balanced accuracy 0.004; FDR 0.019; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
548105.2417534215 3197.2816752679964 208437.83719641133
0.00096972776 2.8307173e-05 0.00094052876
Counter success count is -1
Epoch 18000 train accuracy 0.781408; loss 0.463127; lambda is 0.000010
Epoch 18000 test accuracy 0.779768
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.465524; subspace 0.502503; adv 0.515342
Epoch 18000 spouse consistency 0.970702
Train AUC is 0.856421; balanced AUC is 0.856421
Train accuracy 0.781; balanced accuracy 0.764; FDR 0.455; TPR 0.731

Train Gender accuracy 0.759; balanced accuracy 0.755; FDR 0.409; TPR 0.744

Train Gender gap RMS 0.09083562109189874
Train Race accuracy 0.775; balanced accuracy 0.762; FDR 0.445; TPR 0.734

Train Race gap RMS 0.048463255078221
Train STD accuracy 0.008; balanced accuracy 0.003; FDR 0.018; TPR 0.005

--------------------------------------------------
Test AUC is 0.856972; balanced AUC is 0.856972
Test accuracy 0.780; balanced accuracy 0.766; FDR 0.465; TPR 0.740

Test Gender accuracy 0.757; balanced accuracy 0.756; FDR 0.419; TPR 0.756

Test Gender gap RMS 0.09581274368367879
Test Race accuracy 0.773; balanced accuracy 0.764; FDR 0.456; TPR 0.746

Test Race gap RMS 0.06258684094475733
Test STD accuracy 0.008; balanced accuracy 0.004; FDR 0.019; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
525788.5032976666 3420.521212935563 212116.6485199007
0.0009688331 0.00010876775 0.00093477464
Counter success count is -1
Epoch 19000 train accuracy 0.782901; loss 0.460572; lambda is 0.000010
Epoch 19000 test accuracy 0.781316
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.443518; subspace 0.474519; adv 0.486973
Epoch 19000 spouse consistency 0.971255
Train AUC is 0.857956; balanced AUC is 0.857956
Train accuracy 0.783; balanced accuracy 0.767; FDR 0.453; TPR 0.736

Train Gender accuracy 0.760; balanced accuracy 0.757; FDR 0.408; TPR 0.751

Train Gender gap RMS 0.0955962140367707
Train Race accuracy 0.776; balanced accuracy 0.764; FDR 0.443; TPR 0.739

Train Race gap RMS 0.04834300220592128
Train STD accuracy 0.008; balanced accuracy 0.004; FDR 0.018; TPR 0.006

--------------------------------------------------
Test AUC is 0.858485; balanced AUC is 0.858485
Test accuracy 0.781; balanced accuracy 0.768; FDR 0.462; TPR 0.743

Test Gender accuracy 0.757; balanced accuracy 0.758; FDR 0.418; TPR 0.759

Test Gender gap RMS 0.09712883919835431
Test Race accuracy 0.774; balanced accuracy 0.766; FDR 0.454; TPR 0.749

Test Race gap RMS 0.061944840962698075
Test STD accuracy 0.008; balanced accuracy 0.004; FDR 0.018; TPR 0.005

--------------------------------------------------
Real and fair distances (max/min/mean):
553514.3063227063 2703.3492692873974 208019.7657285883
0.0009688331 0.00010876775 0.00093477464
Counter success count is -1
Epoch 19999 train accuracy 0.783730; loss 0.458225; lambda is 0.000010
Epoch 19999 test accuracy 0.78209
FAILED attacks: subspace 0; full 0; Nans after attack 0
Loss clean 0.452330; subspace 0.472718; adv 0.485057
Epoch 19999 spouse consistency 0.97236
Train AUC is 0.859461; balanced AUC is 0.859461
Train accuracy 0.784; balanced accuracy 0.769; FDR 0.452; TPR 0.740

Train Gender accuracy 0.760; balanced accuracy 0.759; FDR 0.408; TPR 0.755

Train Gender gap RMS 0.10017442935508859
Train Race accuracy 0.777; balanced accuracy 0.766; FDR 0.442; TPR 0.743

Train Race gap RMS 0.04781968309829686
Train STD accuracy 0.009; balanced accuracy 0.004; FDR 0.017; TPR 0.006

--------------------------------------------------
Test AUC is 0.859990; balanced AUC is 0.859990
Test accuracy 0.782; balanced accuracy 0.770; FDR 0.461; TPR 0.747

Test Gender accuracy 0.758; balanced accuracy 0.759; FDR 0.418; TPR 0.763

Test Gender gap RMS 0.1012409388078178
Test Race accuracy 0.775; balanced accuracy 0.768; FDR 0.453; TPR 0.753

Test Race gap RMS 0.060944970420443195
Test STD accuracy 0.009; balanced accuracy 0.004; FDR 0.017; TPR 0.005

--------------------------------------------------

Final train accuracy 0.78373
Final test accuracy 0.78209
Final lambda 0.000010
Gender:
Accuracy is 0.782090
Balanced accuracy is 0.770153
Gap RMS is 0.10124093880781784
Mean absolute gap is 0.10120157684052136
Max gap is 0.10402443632699332
Average odds difference is -0.101202
Equal opportunity difference is -0.104024
Statistical parity difference is -0.200047

Race:
Accuracy is 0.782090
Balanced accuracy is 0.770153
Gap RMS is 0.06094497042044316
Mean absolute gap is 0.06087995406246219
Max gap is 0.0636943124087262
Average odds difference is -0.060880
Equal opportunity difference is -0.058066
Statistical parity difference is -0.114253
